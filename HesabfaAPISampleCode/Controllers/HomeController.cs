using HesabfaAPISampleCode.Models;
using Microsoft.AspNetCore.Mvc;
using NPOI.POIFS.Crypt.Dsig;
using NPOI.SS.Formula.Functions;
using NPOI.SS.UserModel;
using RestSharp;
using RestSharp.Authenticators;
using static Org.BouncyCastle.Crypto.Engines.SM2Engine;

namespace HesabfaAPISampleCode.Controllers
{
    public class HomeController : ControllerBase
    {
        //Add you apikey and login token here properly
        private readonly string apiKey = "QZAIlbJQnCGENqB1lV0Ygx4rTIfln1yg";
        private readonly string loginToken = "af014d3ed841a5d23bfd378670e2fc7e2e15d42b606f62e6a719be090b501343f45531c55f640319dd131dd9649c3709";

        public IActionResult ApiRequest(string method, object data)
        {
            var client = new RestClient("https://api.hesabfa.com/v1");
            var request = new RestRequest(method);
            request.AddJsonBody(new
            {
                apiKey = apiKey,
                loginToken = loginToken,
                data
            });

            var response = client.Post(request);
            return Ok(response);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult GetChanges(int start)
        {
            var method = "/setting/GetChanges";
            var data = new {
                start = start
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult GetFiscalYears()
        {
            var method = "/setting/GetChanges";
            var data = new{};
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult GetCurrency()
        {
            var method = "/setting/GetCurrency";
            var data = new{};
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult GetWarehouses()
        {
            var method = "/setting/GetWarehouses";
            var data = new{};
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult GetProductCategories()
        {
            var method = "/setting/GetProductCategories";
            var data = new{};
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult GetServiceCategories()
        {
            var method = "/setting/GetServiceCategories";
            var data = new{};
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult GetContactCategories()
        {
            var method = "/setting/GetContactCategories";
            var data = new{};
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult GetBanks()
        {
            var method = "/setting/GetBanks";
            var data = new {};
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult GetCashes()
        {
            var method = "/setting/GetCashes";
            var data = new {};
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult GetPettyCashes()
        {
            var method = "/setting/GetPettyCashes";
            var data = new {};
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult GetFiscalYear()
        {
            var method = "/setting/GetFiscalYear";
        var data = new {};
            return ApiRequest(method, data);
        }
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    public IActionResult GetProjects()
        {
            var method = "/setting/GetProjects";
        var data = new {};
            return ApiRequest(method, data);
    }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult GetSalesmen()
        {
            var method = "/setting/GetSalesmen";
            var data = new {};
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult GetCurrencyTable()
        {
            var method = "/setting/GetCurrencyTable";
            var data = new {};
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult SetCurrencyTable(string from, string to, string rate)
        {
            var method = "/setting/SetCurrencyTable";
            var data = new
            {
                Table = new[]
                {
                    new
                    {
                        From = from,
                        To = to,
                        Rate = rate
                    }
                }
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult GetAccounts()
        {
            var method = "/setting/GetAccounts";
            var data = new {};
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult GetBusinessInfo()
        {
            var method = "/setting/GetBusinessInfo";
            var data = new {};
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult ReportBalanceSheet(string startDate, string endDate, string project)
        {
            var method = "/report/balancesheet";
            var data = new {
                startDate = startDate,
                endDate = endDate,
                project = project
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult ReportDebtorsCreditors(string startDate, string endDate, string project)
        {
            var method = "/report/debtorscreditors";
            var data = new {
                startDate = startDate,
                endDate = endDate,
                project = project
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult ReportInventory(string startDate, string endDate, string project)
        {
            var method = "/report/inventory";
            var data = new { };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult ReportProfitAndLossStatement(string startDate, string endDate, string project)
        {
            var method = "/report/profitandlossstatement";
            var data = new
            {
                startDate = startDate,
                endDate = endDate,
                project = project
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult ReportTrialBalanceItems(string startDate, string endDate, string project)
        {
            var method = "/report/trialbalanceitems";
            var data = new
            {
                startDate = startDate,
                endDate = endDate,
                project = project
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult DocumentGet(string startDate, string endDate, string project)
        {
            var method = "/document/get";
            var data = new
            {
                startDate = startDate,
                endDate = endDate,
                project = project
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult DocumentSave(string startDate, string endDate, string project)
        {
            var method = "/document/save";
            var data = new
            {
                startDate = startDate,
                endDate = endDate,
                project = project
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult DocumentGetList(string startDate, string endDate, string project)
        {
            var method = "/document/getdocuments";
            var data = new
            {
                startDate = startDate,
                endDate = endDate,
                project = project
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult DocumentDelete(string startDate, string endDate, string project)
        {
            var method = "/document/delete";
            var data = new
            {
                startDate = startDate,
                endDate = endDate,
                project = project
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult ReceiptGet(int type, int number)
        {
            var method = "/receipt/get";
            var data = new
            {
                type = type,
                number = number
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult ReceiptGetList(int type, object queryInfo)
        {
            var method = "/receipt/getReceipts";
            var data = new
            {
                type = type,
                queryInfo = queryInfo
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult ReceiptSave(int type, string dateTime, string project, string description, string bankCode, string contactCode, string amount, string bankFee, string reference, string currency, string cashCode, string pettyCashCode)
        {
            var method = "/receipt/save";
            var data = new
            {
                Type = type,
                DateTime = dateTime,
                Project = project,
                Description = description,
                BankCode = bankCode,
                ContactCode = contactCode,
                Amount = amount,
                BankFee = bankFee,
                Reference = reference,
                Currency = currency,
                CashCode = cashCode,
                PettyCashCode = pettyCashCode
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult ReceiptDelete(string type, int number)
        {
            var method = "/receipt/delete";
            var data = new
            {
                type = type,
                 number = number
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult InvoiceGet(string type, int number)
        {
            var method = "/invoice/get";
            var data = new
            {
                type = type,
                number = number
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult InvoiceGetById(int id)
        {
            var method = "/invoice/getById";
            var data = new
            {
                id = id
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult InvoiceGetInvoiceList(string type, object queryInfo)
        {
            var method = "/invoice/getinvoices";
            var data = new
            {
                type = type,
                queryInfo = queryInfo
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult InvoiceSave(object invoice)
        {
            var method = "/invoice/save";
            var data = new
            {
                invoice = invoice
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult InvoiceDelete(string type, int number)
        {
            var method = "/invoice/delete";
            var data = new
            {
                type = type,
                number = number
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult InvoiceSavePayment(string type, int number, string bankCode, string date, string amount, string transactionNumber, string description, string transactionFee, string currency, int currencyRate, string cashCode, string pettyCashCode)
        {
            var method = "/invoice/savepayment";
            var data = new
            {
                type = type,
                number = number,
                bankCode = bankCode,
	            date = date,
	            amount = amount,
	            transactionNumber = transactionNumber,
	            description = description,
	            transactionFee = transactionFee,
                currency = currency,
                currencyRate = currencyRate,
                cashCode = cashCode,
                pettyCashCode = pettyCashCode,

            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult InvoiceGetOnlineInvoiceURL(string type, int number)
        {
            var method = "/invoice/getonlineinvoiceurl";
            var data = new
            {
                type = type,
                number = number
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult InvoiceSaveWarehouseReceipt(bool deleteOldReceipts, object receipt)
        {
            var method = "/invoice/SaveWarehouseReceipt";
            var data = new
            {
                deleteOldReceipts = true,
                receipt = receipt
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult ItemGet(string code)
        {
            var method = "/item/get";
            var data = new
            {
                code = code
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult ItemGetByBarcode(string barcode)
        {
            var method = "/item/getByBarcode";
            var data = new
            {
                barcode = barcode
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult ItemGetById(Array idList)
        {
            var method = "/item/getById";
            var data = new
            {
                idList = idList
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult ItemGetItemList(object queryInfo)
        {
            var method = "/item/getitems";
            var data = new
            {
                queryInfo= queryInfo
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult ItemSave(object item)
        {
            var method = "/item/save";
            var data = new
            {
                 item = item
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult ItemDelete(string code)
        {
            var method = "/item/delete";
            var data = new
            {
                code = code
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult ItemGetItemList(int warehouseCode, Array codes)
        {
            var method = "/item/GetQuantity";
            var data = new
            {
                warehouseCode = warehouseCode,			
                codes = codes	
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult ItemUpdateOpeningQuantity(Array items)
        {
            var method = "/item/UpdateOpeningQuantity";
            var data = new
            {
                items = items
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult ContactGet(string code)
        {
            var method = "/contact/get";
            var data = new
            {
                code = code
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult ContactGetByID(Array idList)
        {
            var method = "/contact/getById";
            var data = new
            {
                idList = idList
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult ContactGetContacts(object queryInfo)
        {
            var method = "/contact/getcontacts";
            var data = new
            {
                queryInfo = queryInfo
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult ContactSave(object contact)
        {
            var method = "/contact/save";
            var data = new
            {
                contact = contact
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult ContactDelete(string code)
        {
            var method = "/contact/delete";
            var data = new
            {
                code = code
            };
            return ApiRequest(method, data);
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public IActionResult ContactGetContactLink(string code, bool showAllAccounts, int days)
        {
            var method = "/contact/getContactLink";
            var data = new
            {
                code = code,
                showAllAccounts = showAllAccounts,
                days = days
            };
            return ApiRequest(method, data);
        }
    }
}