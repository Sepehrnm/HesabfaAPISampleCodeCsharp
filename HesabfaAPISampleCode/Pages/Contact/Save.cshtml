@page
@model HesabfaAPISampleCode.Pages.Contact.SaveModel
@{
    ViewData["Title"] = "ذخیره شخص";
}
<div class="container">
    <div class="row">
        <div class="col-12 d-flex flex-column">
            <div class="Error-Container"></div>
            <div class="d-flex gap-2 align-items-center justify-content-evenly">
                <div class="form-group" style="width:100%;">
                    <label for="code" class="form-label">کد شخص</label>
                    <input id="code" class="form-control" name="code" />
                </div>
                <div class="form-group" style="width:100%;">
                    <label for="name" class="form-label">نام شخص</label>
                    <input id="name" class="form-control" name="name" />
                </div>
                <div class="form-group" style="width:100%;">
                    <label for="company" class="form-label">شرکت</label>
                    <input id="company" class="form-control" name="company" />
                </div>
            </div>
            <div class="d-flex gap-2 align-items-center justify-content-evenly">
                <div class="form-group" style="width:100%;">
                    <label for="firstName" class="form-label">نام</label>
                    <input id="firstName" class="form-control" name="firstName" />
                </div>
                <div class="form-group" style="width:100%;">
                    <label for="lastName" class="form-label">نام خانوادگی</label>
                    <input id="lastName" class="form-control" name="lastName" />
                </div>
                <div class="form-group" style="width:100%;">
                    <label for="contactType" class="form-label">نوع شخص</label>
                    <input id="contactType" class="form-control" name="contactType" />
                </div>
            </div>
            <div class="d-flex gap-2 align-items-center justify-content-evenly">
                <div class="form-group" style="width:100%;">
                    <label for="nationalCode" class="form-label">کد/شناسه ملی</label>
                    <input id="nationalCode" class="form-control" name="nationalCode" />
                </div>
                <div class="form-group" style="width:100%;">
                    <label for="economicCode" class="form-label">کد اقتصادی</label>
                    <input id="economicCode" class="form-control" name="economicCode" />
                </div>
                <div class="form-group" style="width:100%;">
                    <label for="registrationNumber" class="form-label">شماره ثبت</label>
                    <input id="registrationNumber" class="form-control" name="registrationNumber" />
                </div>
            </div>
            <div class="d-flex gap-2 align-items-center justify-content-evenly">
                <div class="form-group" style="width:100%;">
                    <label for="address" class="form-label">آدرس شخص</label>
                    <input id="address" class="form-control" name="address" />
                </div>
                <div class="form-group" style="width:100%;">
                    <label for="city" class="form-label">شهر</label>
                    <input id="city" class="form-control" name="city" />
                </div>
                <div class="form-group" style="width:100%;">
                    <label for="state" class="form-label">استان</label>
                    <input id="state" class="form-control" name="state" />
                </div>
            </div>
            <div class="d-flex gap-2 align-items-center justify-content-evenly">
                <div class="form-group" style="width:100%;">
                    <label for="postalCode" class="form-label">کد پستی</label>
                    <input id="postalCode" class="form-control" name="postalCode" />
                </div>
                <div class="form-group" style="width:100%;">
                    <label for="phone" class="form-label">شماره تلفن</label>
                    <input id="phone" class="form-control" name="phone" />
                </div>
                <div class="form-group" style="width:100%;">
                    <label for="fax" class="form-label">شماره فکس</label>
                    <input id="fax" class="form-control" name="fax" />
                </div>
                <div class="form-group" style="width:100%;">
                    <label for="mobile" class="form-label">شماره موبایل</label>
                    <input id="mobile" class="form-control" name="mobile" />
                </div>
                <div class="form-group" style="width:100%;">
                    <label for="email" class="form-label">ایمیل</label>
                    <input id="email" class="form-control" name="email" />
                </div>
            </div>
            <div class="d-flex gap-2 align-items-center justify-content-evenly">
                <div class="form-group" style="width:100%;">
                    <label for="website" class="form-label">وب سایت</label>
                    <input id="website" class="form-control" name="website" />
                </div>
                <div class="form-group" style="width:100%;">
                    <label for="note" class="form-label">یادداشت</label>
                    <input id="note" class="form-control" name="note" />
                </div>
                <div class="form-group" style="width:100%;">
                    <label for="contactCredit" class="form-label">اعتبار مالی</label>
                    <input id="contactCredit" class="form-control" name="contactCredit" />
                </div>
                <div class="form-group" style="width:100%;">
                    <label for="taxType" class="form-label">نوع مالیات</label>
                    <input id="taxType" class="form-control" name="taxType" />
                </div>
                <div class="form-group" style="width:100%;">
                    <label for="active" class="form-label">وضعیت شخص</label>
                    <input id="active" class="form-control" name="active" />
                </div>
            </div>
            <br />
            <button type="submit" class="btn btn-primary submitButton">ذخیره</button>
        </div>
    </div>
</div>

<script type="text/javascript">
    $('.submitButton').on('click', () => {

        let code = $('#code').val();
        let name = $('#name').val();
        let company = $('#company').val();
        let firstName = $('#firstName').val();
        let lastName = $('#lastName').val();
        let contactType = $('#contactType').val();
        let nationalCode = $('#nationalCode').val();
        let economicCode = $('#economicCode').val();
        let registrationNumber = $('#registrationNumber').val();
        let address = $('#address').val();
        let city = $('#city').val();
        let state = $('#state').val();
        let postalCode = $('#postalCode').val();
        let phone = $('#phone').val();
        let fax = $('#fax').val();
        let mobile = $('#mobile').val();
        let email = $('#email').val();
        let website = $('#website').val();
        let note = $('#note').val();
        let contactCredit = $('#contactCredit').val();
        let taxType = $('#taxType').val();
        let active = $('#active').val();


        let requestBody = {
            code: code,
            name: name,
            company: company,
            firstName: firstName,
            lastName: lastName,
            contactType: contactType,
            nationalCode: nationalCode,
            economicCode: economicCode,
            registrationNumber: registrationNumber,
            address: address,
            city: city,
            state: state,
            postalCode: postalCode,
            phone: phone,
            fax: fax,
            mobile: mobile,
            email: email,
            website: website,
            note: note,
            contactCredit: contactCredit,
            taxType: taxType,
            active: active,
        };

        fetch("/api/Contact/Save", {
            method: 'POST',
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(requestBody)
        })
            .then(response => {
                return response.json();
            })
            .then(data => {
                if (data.code) {
                    $(".Error-Container").css("display", "none");
                    alert("شخص اضافه گردید");
                } else {
                    $(".Error-Container").css("display", "block");
                    $(".Error-Container").addClass("alert alert-danger");
                    $(".Error-Container").css("direction", "ltr");
                    $(".Error-Container").text(`ErrorCode: ${data.errorCode} ErrorMessage: ${data.errorMessage}`);
                }
            })
            .catch(error => console.error('Error Occured.', error));
    })
</script>